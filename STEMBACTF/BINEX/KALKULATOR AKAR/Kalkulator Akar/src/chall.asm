;
; +-------------------------------------------------------------------------+
; |      This file was generated by The Interactive Disassembler (IDA)      |
; |           Copyright (c) 2025 Hex-Rays, <support@hex-rays.com>           |
; |                            Freeware version                             |
; +-------------------------------------------------------------------------+
;
; Input SHA256 : 7970683D180C110F21F6F4CC312B53AEB305F0A7ED9C6DD97CD9784B0E2BF9D3
; Input MD5    : A1A859D840FA5F76CCC5F2617F7117DC
; Input CRC32  : 36D7763D
; Compiler     : GNU C++

; File Name   : D:\CTF #2\STEMBACTF\BINEX\KALKULATOR AKAR\Kalkulator Akar\src\chall
; Format      : ELF for Intel 386 (Executable)
; Imagebase   : 8048000
; Interpreter '/lib/ld-linux.so.2'
; Needed Library 'libm.so.6'
; Needed Library 'libc.so.6'
;
; Source File : 'crtstuff.c'
; Source File : 'chall.c'
; Source File : 'crtstuff.c'

.686p
.mmx
.model flat
.intel_syntax noprefix


; Segment type: Pure data
; Segment permissions: Read
LOAD segment mempage public 'DATA' use32
assume cs:LOAD
;org 8048000h
dword_8048000 dd 464C457Fh ; File format: \x7FELF
db 1                    ; File class: 32-bit
db 1                    ; Data encoding: little-endian
db 1                    ; File version
db 0                    ; OS/ABI: UNIX System V ABI
db 0                    ; ABI Version
db 7 dup(0)             ; Padding
dw 2                    ; File type: Executable
dw 3                    ; Machine: Intel 386
dd 1                    ; File version
dd offset _start        ; Entry point
dd 34h                  ; PHT file offset
dd 3908h                ; SHT file offset
dd 0                    ; Processor-specific flags
dw 34h                  ; ELF header size
dw 20h                  ; PHT entry size
dw 0Bh                  ; Number of entries in PHT
dw 28h                  ; SHT entry size
dw 1Dh                  ; Number of entries in SHT
dw 1Ch                  ; SHT entry index for string table
; ELF32 Program Header
; PHT Entry 0
dword_8048034 dd 6      ; Type: PHDR
dd 34h                  ; File offset
dd offset dword_8048034 ; Virtual address
dd 8048034h             ; Physical address
dd 160h                 ; Size in file image
dd 160h                 ; Size in memory image
dd 4                    ; Flags
dd 4                    ; Alignment
; PHT Entry 1
dd 3                    ; Type: INTERP
dd 194h                 ; File offset
dd offset aLibLdLinuxSo2 ; Virtual address
dd 8048194h             ; Physical address
dd 13h                  ; Size in file image
dd 13h                  ; Size in memory image
dd 4                    ; Flags
dd 1                    ; Alignment
; PHT Entry 2
dd 1                    ; Type: LOAD
dd 0                    ; File offset
dd offset dword_8048000 ; Virtual address
dd 8048000h             ; Physical address
dd 458h                 ; Size in file image
dd 458h                 ; Size in memory image
dd 4                    ; Flags
dd 1000h                ; Alignment
; PHT Entry 3
dd 1                    ; Type: LOAD
dd 1000h                ; File offset
dd offset _init_proc    ; Virtual address
dd 8049000h             ; Physical address
dd 3ECh                 ; Size in file image
dd 3ECh                 ; Size in memory image
dd 5                    ; Flags
dd 1000h                ; Alignment
; PHT Entry 4
dd 1                    ; Type: LOAD
dd 2000h                ; File offset
dd offset _fp_hw        ; Virtual address
dd 804A000h             ; Physical address
dd 328h                 ; Size in file image
dd 328h                 ; Size in memory image
dd 4                    ; Flags
dd 1000h                ; Alignment
; PHT Entry 5
dd 1                    ; Type: LOAD
dd 2EF8h                ; File offset
dd offset __frame_dummy_init_array_entry ; Virtual address
dd 804BEF8h             ; Physical address
dd 140h                 ; Size in file image
dd 144h                 ; Size in memory image
dd 6                    ; Flags
dd 1000h                ; Alignment
; PHT Entry 6
dd 2                    ; Type: DYNAMIC
dd 2F00h                ; File offset
dd offset _DYNAMIC      ; Virtual address
dd 804BF00h             ; Physical address
dd 0F0h                 ; Size in file image
dd 0F0h                 ; Size in memory image
dd 6                    ; Flags
dd 4                    ; Alignment
; PHT Entry 7
dd 4                    ; Type: NOTE
dd 1A8h                 ; File offset
dd offset dword_80481A8 ; Virtual address
dd 80481A8h             ; Physical address
dd 44h                  ; Size in file image
dd 44h                  ; Size in memory image
dd 4                    ; Flags
dd 4                    ; Alignment
; PHT Entry 8
dd 6474E550h            ; Type: EH_FRAME
dd 2120h                ; File offset
dd offset __GNU_EH_FRAME_HDR ; Virtual address
dd 804A120h             ; Physical address
dd 64h                  ; Size in file image
dd 64h                  ; Size in memory image
dd 4                    ; Flags
dd 4                    ; Alignment
; PHT Entry 9
dd 6474E551h            ; Type: STACK
dd 0                    ; File offset
dd 0                    ; Virtual address
dd 0                    ; Physical address
dd 0                    ; Size in file image
dd 0                    ; Size in memory image
dd 7                    ; Flags
dd 10h                  ; Alignment
; PHT Entry 10
dd 6474E552h            ; Type: RO-AFTER
dd 2EF8h                ; File offset
dd offset __frame_dummy_init_array_entry ; Virtual address
dd 804BEF8h             ; Physical address
dd 108h                 ; Size in file image
dd 108h                 ; Size in memory image
dd 4                    ; Flags
dd 1                    ; Alignment
aLibLdLinuxSo2 db '/lib/ld-linux.so.2',0
align 4
; ELF Note Entry
dword_80481A8 dd 4      ; Name Size
dd 14h                  ; Desc Size
dd 3                    ; Type: NT_GNU_BUILD_ID
aGnu db 'GNU',0         ; Name
db 0E1h, 40h, 1Eh, 39h, 94h, 9Fh, 28h, 72h ; Desc
db 0D4h, 24h, 32h, 0E2h, 76h, 0F2h, 23h
db 8Ah, 76h, 0D1h, 0BCh, 25h
; ELF Note Entry
dd 4                    ; Name Size
dd 10h                  ; Desc Size
dd 1                    ; Type: NT_GNU_ABI_TAG
aGnu_0 db 'GNU',0       ; Name
dd 0, 3, 2, 0           ; ABI: Linux 3.2.0
; ELF GNU Hash Table
elf_gnu_hash_nbuckets dd 2
elf_gnu_hash_symbias dd 0Eh
elf_gnu_hash_bitmask_nwords dd 1
elf_gnu_hash_shift dd 5
elf_gnu_hash_indexes dd 20002000h
elf_gnu_hash_bucket dd 0, 0Eh
elf_gnu_hash_chain dd 0C0E34BADh
; ELF Symbol Table
Elf32_Sym <0>
Elf32_Sym <offset aPrintf - offset unk_80482FC,\ ; "printf"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aGets - offset unk_80482FC,\ ; "gets"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aStderr - offset unk_80482FC,\ ; "stderr"
           0, 0, 11h, 0, 0>
Elf32_Sym <offset aSetgid - offset unk_80482FC,\ ; "setgid"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aPuts - offset unk_80482FC,\ ; "puts"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aGmonStart - offset unk_80482FC,\ ; "__gmon_start__"
           0, 0, 20h, 0, 0>
Elf32_Sym <offset aLibcStartMain - offset unk_80482FC,\ ; "__libc_start_main"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aStdin - offset unk_80482FC,\ ; "stdin"
           0, 0, 11h, 0, 0>
Elf32_Sym <offset aSetvbuf - offset unk_80482FC,\ ; "setvbuf"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aSqrt - offset unk_80482FC,\ ; "sqrt"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aStdout - offset unk_80482FC,\ ; "stdout"
           0, 0, 11h, 0, 0>
Elf32_Sym <offset aSetuid - offset unk_80482FC,\ ; "setuid"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aAtoi - offset unk_80482FC,\ ; "atoi"
           0, 0, 12h, 0, 0>
Elf32_Sym <offset aIoStdinUsed - offset unk_80482FC,\ ; "_IO_stdin_used"
           offset _IO_stdin_used, 4, \
           11h, 0, 0Fh>
; ELF String Table
unk_80482FC db    0
aGmonStart db '__gmon_start__',0
aSqrt db 'sqrt',0
aIoStdinUsed db '_IO_stdin_used',0
aSetuid db 'setuid',0
aGets db 'gets',0
aPuts db 'puts',0
aStdin db 'stdin',0
aPrintf db 'printf',0
aStdout db 'stdout',0
aStderr db 'stderr',0
aAtoi db 'atoi',0
aSetvbuf db 'setvbuf',0
aSetgid db 'setgid',0
aLibcStartMain db '__libc_start_main',0
aLibmSo6 db 'libm.so.6',0
aLibcSo6 db 'libc.so.6',0
aGlibc20 db 'GLIBC_2.0',0
; ELF GNU Symbol Version Table
dw 0
dw 2                    ; printf@@GLIBC_2.0
dw 2                    ; gets@@GLIBC_2.0
dw 2                    ; stderr@@GLIBC_2.0
dw 2                    ; setgid@@GLIBC_2.0
dw 2                    ; puts@@GLIBC_2.0
dw 0                    ; local  symbol: __gmon_start__
dw 2                    ; __libc_start_main@@GLIBC_2.0
dw 2                    ; stdin@@GLIBC_2.0
dw 2                    ; setvbuf@@GLIBC_2.0
dw 3                    ; sqrt@@GLIBC_2.0
dw 2                    ; stdout@@GLIBC_2.0
dw 2                    ; setuid@@GLIBC_2.0
dw 2                    ; atoi@@GLIBC_2.0
dw 1                    ; global symbol: _IO_stdin_used
dw 0
; ELF GNU Symbol Version Requirements
Elf32_Verneed <1, 1, \  ; "libm.so.6"
               offset aLibmSo6 - offset unk_80482FC,\
               10h, 20h>
Elf32_Vernaux <0D696910h, 0, 3, \ ; "GLIBC_2.0"
               offset aGlibc20 - offset unk_80482FC,\
               0>
Elf32_Verneed <1, 1, \  ; "libc.so.6"
               offset aLibcSo6 - offset unk_80482FC,\
               10h, 0>
Elf32_Vernaux <0D696910h, 0, 2, \ ; "GLIBC_2.0"
               offset aGlibc20 - offset unk_80482FC,\
               0>
; ELF REL Relocation Table
Elf32_Rel <804BFF0h, 306h> ; R_386_GLOB_DAT stderr
Elf32_Rel <804BFF4h, 606h> ; R_386_GLOB_DAT __gmon_start__
Elf32_Rel <804BFF8h, 806h> ; R_386_GLOB_DAT stdin
Elf32_Rel <804BFFCh, 0B06h> ; R_386_GLOB_DAT stdout
; ELF JMPREL Relocation Table
Elf32_Rel <804C00Ch, 107h> ; R_386_JMP_SLOT printf
Elf32_Rel <804C010h, 207h> ; R_386_JMP_SLOT gets
Elf32_Rel <804C014h, 407h> ; R_386_JMP_SLOT setgid
Elf32_Rel <804C018h, 507h> ; R_386_JMP_SLOT puts
Elf32_Rel <804C01Ch, 707h> ; R_386_JMP_SLOT __libc_start_main
Elf32_Rel <804C020h, 907h> ; R_386_JMP_SLOT setvbuf
Elf32_Rel <804C024h, 0A07h> ; R_386_JMP_SLOT sqrt
Elf32_Rel <804C028h, 0C07h> ; R_386_JMP_SLOT setuid
Elf32_Rel <804C02Ch, 0D07h> ; R_386_JMP_SLOT atoi
LOAD ends


; Segment type: Pure code
; Segment permissions: Read/Execute
_init segment dword public 'CODE' use32
assume cs:_init
;org 8049000h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing


; Alternative name is '_init'

public _init_proc
_init_proc proc near
push    ebx
sub     esp, 8
call    __x86_get_pc_thunk_bx
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
mov     eax, ds:(__gmon_start___ptr - 804C000h)[ebx]
test    eax, eax
jz      short loc_804901B
call    eax

loc_804901B:
add     esp, 8
pop     ebx
retn
_init_proc endp

_init ends


; Segment type: Pure code
; Segment permissions: Read/Execute
_plt segment para public 'CODE' use32
assume cs:_plt
;org 8049020h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing



sub_8049020 proc near
; __unwind {
push    ds:dword_804C004
jmp     ds:dword_804C008
sub_8049020 endp

align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _printf. PRESS CTRL-NUMPAD+ TO EXPAND]
push    0
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _gets. PRESS CTRL-NUMPAD+ TO EXPAND]
push    8
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _setgid. PRESS CTRL-NUMPAD+ TO EXPAND]
push    10h
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _puts. PRESS CTRL-NUMPAD+ TO EXPAND]
push    18h
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION ___libc_start_main. PRESS CTRL-NUMPAD+ TO EXPAND]
push    20h ; ' '
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _setvbuf. PRESS CTRL-NUMPAD+ TO EXPAND]
push    28h ; '('
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _sqrt. PRESS CTRL-NUMPAD+ TO EXPAND]
push    30h ; '0'
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _setuid. PRESS CTRL-NUMPAD+ TO EXPAND]
push    38h ; '8'
jmp     sub_8049020
; [00000006 BYTES: COLLAPSED FUNCTION _atoi. PRESS CTRL-NUMPAD+ TO EXPAND]
push    40h ; '@'
jmp     sub_8049020
; } // starts at 8049020
_plt ends


; Segment type: Pure code
; Segment permissions: Read/Execute
_text segment para public 'CODE' use32
assume cs:_text
;org 80490C0h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing


; Attributes: noreturn fuzzy-sp

public _start
_start proc near
; __unwind {
xor     ebp, ebp
pop     esi
mov     ecx, esp
and     esp, 0FFFFFFF0h
push    eax
push    esp             ; stack_end
push    edx             ; rtld_fini
call    sub_80490F3
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
lea     eax, (__libc_csu_fini - 804C000h)[ebx]
push    eax             ; fini
lea     eax, (__libc_csu_init - 804C000h)[ebx]
push    eax             ; init
push    ecx             ; ubp_av
push    esi             ; argc
mov     eax, offset main
push    eax             ; main
call    ___libc_start_main
hlt
_start endp




sub_80490F3 proc near
mov     ebx, [esp+0]
retn
; } // starts at 80490C0
sub_80490F3 endp

align 10h



public _dl_relocate_static_pie
_dl_relocate_static_pie proc near
; __unwind {
retn
; } // starts at 8049100
_dl_relocate_static_pie endp

align 10h



public __x86_get_pc_thunk_bx
__x86_get_pc_thunk_bx proc near
mov     ebx, [esp+0]
retn
__x86_get_pc_thunk_bx endp

align 10h



deregister_tm_clones proc near
mov     eax, offset __TMC_END__
cmp     eax, offset __TMC_END__
jz      short locret_8049150
mov     eax, 0
test    eax, eax
jz      short locret_8049150
push    ebp
mov     ebp, esp
sub     esp, 14h
push    offset __TMC_END__
call    eax
add     esp, 10h
leave
retn
align 10h

locret_8049150:
retn
deregister_tm_clones endp

align 10h



register_tm_clones proc near
mov     eax, offset __TMC_END__
sub     eax, offset __TMC_END__
mov     edx, eax
shr     eax, 1Fh
sar     edx, 2
add     eax, edx
sar     eax, 1
jz      short locret_8049198
mov     edx, 0
test    edx, edx
jz      short locret_8049198
push    ebp
mov     ebp, esp
sub     esp, 10h
push    eax
push    offset __TMC_END__
call    edx
add     esp, 10h
leave
retn
align 8

locret_8049198:
retn
register_tm_clones endp

align 10h



__do_global_dtors_aux proc near
cmp     ds:__TMC_END__, 0
jnz     short locret_80491C0
push    ebp
mov     ebp, esp
sub     esp, 8
call    deregister_tm_clones
mov     ds:__TMC_END__, 1
leave
retn
align 10h

locret_80491C0:
retn
__do_global_dtors_aux endp

align 10h



frame_dummy proc near
jmp     short register_tm_clones
frame_dummy endp



; Attributes: bp-based frame

public setup
setup proc near

var_4= dword ptr -4

; __unwind {
push    ebp
mov     ebp, esp
push    ebx
sub     esp, 4
call    __x86_get_pc_thunk_bx
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
mov     eax, ds:(stdin_ptr - 804C000h)[ebx]
mov     eax, [eax]
push    0               ; n
push    2               ; modes
push    0               ; buf
push    eax             ; stream
call    _setvbuf
add     esp, 10h
mov     eax, ds:(stdout_ptr - 804C000h)[ebx]
mov     eax, [eax]
push    0               ; n
push    2               ; modes
push    0               ; buf
push    eax             ; stream
call    _setvbuf
add     esp, 10h
mov     eax, ds:(stderr_ptr - 804C000h)[ebx]
mov     eax, [eax]
push    0               ; n
push    2               ; modes
push    0               ; buf
push    eax             ; stream
call    _setvbuf
add     esp, 10h
nop
mov     ebx, [ebp+var_4]
leave
retn
; } // starts at 80491D2
setup endp



; Attributes: bp-based frame

public s3cr37
s3cr37 proc near
; __unwind {
push    ebp
mov     ebp, esp
call    __x86_get_pc_thunk_ax
add     eax, (offset _GLOBAL_OFFSET_TABLE_ - $)
jmp     esp
s3cr37 endp

db 90h
pop     ebp
retn
; } // starts at 804922F


; Attributes: bp-based frame

public calculator
calculator proc near

var_90= qword ptr -90h
s= byte ptr -88h
var_4= dword ptr -4

; __unwind {
push    ebp
mov     ebp, esp
push    ebx
sub     esp, 94h
call    __x86_get_pc_thunk_bx
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
sub     esp, 0Ch
lea     eax, (aAkarPangkat2Da - 804C000h)[ebx] ; "AKAR pangkat 2 dari 16 adalah 2"
push    eax             ; s
call    _puts
add     esp, 10h
sub     esp, 0Ch
lea     eax, (aGunakanKalkula - 804C000h)[ebx] ; "Gunakan kalkulator ini untuk mendapatka"...
push    eax             ; s
call    _puts
add     esp, 10h
sub     esp, 0Ch
lea     eax, (aContoh164Kayak - 804C000h)[ebx] ; "Contoh 16 = 4, kayaknya flag ada di ser"...
push    eax             ; s
call    _puts
add     esp, 10h
sub     esp, 0Ch
lea     eax, (aMasukanAngkamu - 804C000h)[ebx] ; "Masukan angkamu: "
push    eax             ; s
call    _puts
add     esp, 10h
sub     esp, 0Ch
lea     eax, [ebp+s]
push    eax             ; s
call    _gets
add     esp, 10h
sub     esp, 0Ch
lea     eax, [ebp+s]
push    eax             ; nptr
call    _atoi
add     esp, 10h
mov     dword ptr [ebp+var_90], eax
fild    dword ptr [ebp+var_90]
sub     esp, 8
lea     esp, [esp-8]
fstp    qword ptr [esp] ; x
call    _sqrt
add     esp, 10h
fstp    [ebp+var_90]
sub     esp, 0Ch
lea     eax, [ebp+s]
push    eax             ; nptr
call    _atoi
add     esp, 10h
push    dword ptr [ebp+var_90+4]
push    dword ptr [ebp+var_90]
push    eax
lea     eax, (aTheSquareRootO - 804C000h)[ebx] ; "\nThe square root of %d: %.4lf\n"
push    eax             ; format
call    _printf
add     esp, 10h
nop
mov     ebx, [ebp+var_4]
leave
retn
; } // starts at 8049241
calculator endp



; Attributes: bp-based frame fuzzy-sp

; int __cdecl main(int argc, const char **argv, const char **envp)
public main
main proc near

argc= dword ptr  8
argv= dword ptr  0Ch
envp= dword ptr  10h

; __unwind {
lea     ecx, [esp+4]
and     esp, 0FFFFFFF0h
push    dword ptr [ecx-4]
push    ebp
mov     ebp, esp
push    ebx
push    ecx
call    __x86_get_pc_thunk_bx
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
sub     esp, 0Ch
push    0               ; uid
call    _setuid
add     esp, 10h
sub     esp, 0Ch
push    0               ; gid
call    _setgid
add     esp, 10h
call    setup
call    calculator
mov     eax, 0
lea     esp, [ebp-8]
pop     ecx
pop     ebx
pop     ebp
lea     esp, [ecx-4]
retn
; } // starts at 804931A
main endp




public __x86_get_pc_thunk_ax
__x86_get_pc_thunk_ax proc near
; __unwind {
mov     eax, [esp+0]
retn
; } // starts at 8049367
__x86_get_pc_thunk_ax endp

align 10h



public __libc_csu_init
__libc_csu_init proc near

arg_0= dword ptr  4
arg_4= dword ptr  8
arg_8= dword ptr  0Ch

; __unwind {
push    ebp
call    __x86_get_pc_thunk_bp
add     ebp, (offset _GLOBAL_OFFSET_TABLE_ - $)
push    edi
push    esi
push    ebx
sub     esp, 0Ch
mov     ebx, ebp
mov     edi, [esp+1Ch+arg_8]
call    _init_proc
lea     ebx, [ebp-104h]
lea     eax, [ebp-108h]
sub     ebx, eax
sar     ebx, 2
jz      short loc_80493C5
xor     esi, esi
lea     esi, [esi+0]

loc_80493A8:
sub     esp, 4
push    edi
push    [esp+24h+arg_4]
push    [esp+28h+arg_0]
call    ss:(__frame_dummy_init_array_entry - 804C000h)[ebp+esi*4]
add     esi, 1
add     esp, 10h
cmp     ebx, esi
jnz     short loc_80493A8

loc_80493C5:
add     esp, 0Ch
pop     ebx
pop     esi
pop     edi
pop     ebp
retn
; } // starts at 8049370
__libc_csu_init endp

align 10h



public __libc_csu_fini
__libc_csu_fini proc near
; __unwind {
retn
; } // starts at 80493D0
__libc_csu_fini endp




public __x86_get_pc_thunk_bp
__x86_get_pc_thunk_bp proc near
; __unwind {
mov     ebp, [esp+0]
retn
; } // starts at 80493D1
__x86_get_pc_thunk_bp endp

_text ends


; Segment type: Pure code
; Segment permissions: Read/Execute
LOAD segment mempage public 'CODE' use32
assume cs:LOAD
;org 80493D5h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
align 4
LOAD ends


; Segment type: Pure code
; Segment permissions: Read/Execute
_fini segment dword public 'CODE' use32
assume cs:_fini
;org 80493D8h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing


; Alternative name is '_fini'

public _term_proc
_term_proc proc near
push    ebx
sub     esp, 8
call    __x86_get_pc_thunk_bx
add     ebx, (offset _GLOBAL_OFFSET_TABLE_ - $)
add     esp, 8
pop     ebx
retn
_term_proc endp

_fini ends


; Segment type: Pure data
; Segment permissions: Read
_rodata segment dword public 'CONST' use32
assume cs:_rodata
;org 804A000h
public _fp_hw
_fp_hw db    3
db    0
db    0
db    0
public _IO_stdin_used
_IO_stdin_used db    1
db    0
db    2
db    0
aAkarPangkat2Da db 'AKAR pangkat 2 dari 16 adalah 2',0
aGunakanKalkula db 'Gunakan kalkulator ini untuk mendap'
db 'atkan sendiri AKAR pangkat 2 dari a'
db 'ngka yang kamu mau!',0
align 4
aContoh164Kayak db 'Contoh 16 = 4, kayaknya flag ada di'
db ' server ini tapi kamu gak bakal bis'
db 'a dapetin kalau gak punya AKAR!',0Ah
db 0
aMasukanAngkamu db 'Masukan angkamu: ',0
align 10h
aTheSquareRootO db 0Ah
db 'The square root of %d: %.4lf',0Ah,0
_rodata ends


; Segment type: Pure data
; Segment permissions: Read
LOAD segment mempage public 'DATA' use32
assume cs:LOAD
;org 804A11Fh
align 10h
LOAD ends


; Segment type: Pure data
; Segment permissions: Read
_eh_frame_hdr segment dword public 'CONST' use32
assume cs:_eh_frame_hdr
;org 804A120h
__GNU_EH_FRAME_HDR db    1
db  1Bh
db    3
db  3Bh ; ;
db  60h ; `
db    0
db    0
db    0
db  0Bh
db    0
db    0
db    0
db    0
db 0EFh
db 0FFh
db 0FFh
db 0BCh
db    0
db    0
db    0
db 0A0h
db 0EFh
db 0FFh
db 0FFh
db  7Ch ; |
db    0
db    0
db    0
db 0E0h
db 0EFh
db 0FFh
db 0FFh
db 0A8h
db    0
db    0
db    0
db 0B2h
db 0F0h
db 0FFh
db 0FFh
db 0E0h
db    0
db    0
db    0
db  0Fh
db 0F1h
db 0FFh
db 0FFh
db    4
db    1
db    0
db    0
db  21h ; !
db 0F1h
db 0FFh
db 0FFh
db  24h ; $
db    1
db    0
db    0
db 0FAh
db 0F1h
db 0FFh
db 0FFh
db  48h ; H
db    1
db    0
db    0
db  47h ; G
db 0F2h
db 0FFh
db 0FFh
db  7Ch ; |
db    1
db    0
db    0
db  50h ; P
db 0F2h
db 0FFh
db 0FFh
db  90h
db    1
db    0
db    0
db 0B0h
db 0F2h
db 0FFh
db 0FFh
db 0DCh
db    1
db    0
db    0
db 0B1h
db 0F2h
db 0FFh
db 0FFh
db 0F0h
db    1
db    0
db    0
_eh_frame_hdr ends


; Segment type: Pure data
; Segment permissions: Read
_eh_frame segment dword public 'CONST' use32
assume cs:_eh_frame
;org 804A184h
db  14h
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    1
db  7Ah ; z
db  52h ; R
db    0
db    1
db  7Ch ; |
db    8
db    1
db  1Bh
db  0Ch
db    4
db    4
db  88h
db    1
db    7
db    8
db  10h
db    0
db    0
db    0
db  1Ch
db    0
db    0
db    0
db  1Ch
db 0EFh
db 0FFh
db 0FFh
db  37h ; 7
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db  14h
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    1
db  7Ah ; z
db  52h ; R
db    0
db    1
db  7Ch ; |
db    8
db    1
db  1Bh
db  0Ch
db    4
db    4
db  88h
db    1
db    0
db    0
db  10h
db    0
db    0
db    0
db  1Ch
db    0
db    0
db    0
db  30h ; 0
db 0EFh
db 0FFh
db 0FFh
db    1
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db  20h
db    0
db    0
db    0
db  30h ; 0
db    0
db    0
db    0
db  3Ch ; <
db 0EEh
db 0FFh
db 0FFh
db 0A0h
db    0
db    0
db    0
db    0
db  0Eh
db    8
db  46h ; F
db  0Eh
db  0Ch
db  4Ah ; J
db  0Fh
db  0Bh
db  74h ; t
db    4
db  78h ; x
db    0
db  3Fh ; ?
db  1Ah
db  3Bh ; ;
db  2Ah ; *
db  32h ; 2
db  24h ; $
db  22h ; "
db  20h
db    0
db    0
db    0
db  54h ; T
db    0
db    0
db    0
db 0CAh
db 0EFh
db 0FFh
db 0FFh
db  5Dh ; ]
db    0
db    0
db    0
db    0
db  41h ; A
db  0Eh
db    8
db  85h
db    2
db  42h ; B
db  0Dh
db    5
db  44h ; D
db  83h
db    3
db    2
db  55h ; U
db 0C5h
db 0C3h
db  0Ch
db    4
db    4
db    0
db  1Ch
db    0
db    0
db    0
db  78h ; x
db    0
db    0
db    0
db    3
db 0F0h
db 0FFh
db 0FFh
db  12h
db    0
db    0
db    0
db    0
db  41h ; A
db  0Eh
db    8
db  85h
db    2
db  42h ; B
db  0Dh
db    5
db  4Eh ; N
db 0C5h
db  0Ch
db    4
db    4
db    0
db    0
db  20h
db    0
db    0
db    0
db  98h
db    0
db    0
db    0
db 0F5h
db 0EFh
db 0FFh
db 0FFh
db 0D9h
db    0
db    0
db    0
db    0
db  41h ; A
db  0Eh
db    8
db  85h
db    2
db  42h ; B
db  0Dh
db    5
db  47h ; G
db  83h
db    3
db    2
db 0CEh
db 0C5h
db 0C3h
db  0Ch
db    4
db    4
db    0
db  30h ; 0
db    0
db    0
db    0
db 0BCh
db    0
db    0
db    0
db 0AAh
db 0F0h
db 0FFh
db 0FFh
db  4Dh ; M
db    0
db    0
db    0
db    0
db  44h ; D
db  0Ch
db    1
db    0
db  47h ; G
db  10h
db    5
db    2
db  75h ; u
db    0
db  44h ; D
db  0Fh
db    3
db  75h ; u
db  78h ; x
db    6
db  10h
db    3
db    2
db  75h ; u
db  7Ch ; |
db  78h ; x
db 0C1h
db  0Ch
db    1
db    0
db  41h ; A
db 0C3h
db  41h ; A
db 0C5h
db  43h ; C
db  0Ch
db    4
db    4
db    0
db  10h
db    0
db    0
db    0
db 0F0h
db    0
db    0
db    0
db 0C3h
db 0F0h
db 0FFh
db 0FFh
db    4
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db  48h ; H
db    0
db    0
db    0
db    4
db    1
db    0
db    0
db 0B8h
db 0F0h
db 0FFh
db 0FFh
db  5Dh ; ]
db    0
db    0
db    0
db    0
db  41h ; A
db  0Eh
db    8
db  85h
db    2
db  4Ch ; L
db  0Eh
db  0Ch
db  87h
db    3
db  41h ; A
db  0Eh
db  10h
db  86h
db    4
db  41h ; A
db  0Eh
db  14h
db  83h
db    5
db  43h ; C
db  0Eh
db  20h
db  69h ; i
db  0Eh
db  24h ; $
db  41h ; A
db  0Eh
db  28h ; (
db  44h ; D
db  0Eh
db  2Ch ; ,
db  44h ; D
db  0Eh
db  30h ; 0
db  4Dh ; M
db  0Eh
db  20h
db  47h ; G
db  0Eh
db  14h
db  41h ; A
db 0C3h
db  0Eh
db  10h
db  41h ; A
db 0C6h
db  0Eh
db  0Ch
db  41h ; A
db 0C7h
db  0Eh
db    8
db  41h ; A
db 0C5h
db  0Eh
db    4
db    0
db    0
db  10h
db    0
db    0
db    0
db  50h ; P
db    1
db    0
db    0
db 0CCh
db 0F0h
db 0FFh
db 0FFh
db    1
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db  10h
db    0
db    0
db    0
db  64h ; d
db    1
db    0
db    0
db 0B9h
db 0F0h
db 0FFh
db 0FFh
db    4
db    0
db    0
db    0
db    0
db    0
db    0
db    0
__FRAME_END__ db    0
db    0
db    0
db    0
_eh_frame ends

; ELF Initialization Function Table

; Segment type: Pure data
; Segment permissions: Read/Write
_init_array segment dword public 'DATA' use32
assume cs:_init_array
;org 804BEF8h
__frame_dummy_init_array_entry dd offset frame_dummy ; Alternative name is '__init_array_start'
_init_array ends

; ELF Termination Function Table

; Segment type: Pure data
; Segment permissions: Read/Write
_fini_array segment dword public 'DATA' use32
assume cs:_fini_array
;org 804BEFCh
__do_global_dtors_aux_fini_array_entry dd offset __do_global_dtors_aux ; Alternative name is '__init_array_end'
_fini_array ends

; ELF Dynamic Information

; Segment type: Pure data
; Segment permissions: Read/Write
LOAD segment mempage public 'DATA' use32
assume cs:LOAD
;org 804BF00h
_DYNAMIC Elf32_Dyn <1, <76h>> ; DT_NEEDED libm.so.6
Elf32_Dyn <1, <80h>>    ; DT_NEEDED libc.so.6
Elf32_Dyn <0Ch, <8049000h>> ; DT_INIT
Elf32_Dyn <0Dh, <80493D8h>> ; DT_FINI
Elf32_Dyn <19h, <804BEF8h>> ; DT_INIT_ARRAY
Elf32_Dyn <1Bh, <4>>    ; DT_INIT_ARRAYSZ
Elf32_Dyn <1Ah, <804BEFCh>> ; DT_FINI_ARRAY
Elf32_Dyn <1Ch, <4>>    ; DT_FINI_ARRAYSZ
Elf32_Dyn <6FFFFEF5h, <80481ECh>> ; DT_GNU_HASH
Elf32_Dyn <5, <80482FCh>> ; DT_STRTAB
Elf32_Dyn <6, <804820Ch>> ; DT_SYMTAB
Elf32_Dyn <0Ah, <94h>>  ; DT_STRSZ
Elf32_Dyn <0Bh, <10h>>  ; DT_SYMENT
Elf32_Dyn <15h, <0>>    ; DT_DEBUG
Elf32_Dyn <3, <804C000h>> ; DT_PLTGOT
Elf32_Dyn <2, <48h>>    ; DT_PLTRELSZ
Elf32_Dyn <14h, <11h>>  ; DT_PLTREL
Elf32_Dyn <17h, <8048410h>> ; DT_JMPREL
Elf32_Dyn <11h, <80483F0h>> ; DT_REL
Elf32_Dyn <12h, <20h>>  ; DT_RELSZ
Elf32_Dyn <13h, <8>>    ; DT_RELENT
Elf32_Dyn <6FFFFFFEh, <80483B0h>> ; DT_VERNEED
Elf32_Dyn <6FFFFFFFh, <2>> ; DT_VERNEEDNUM
Elf32_Dyn <6FFFFFF0h, <8048390h>> ; DT_VERSYM
Elf32_Dyn <0>           ; DT_NULL
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
db    0
LOAD ends


; Segment type: Pure data
; Segment permissions: Read/Write
_got segment dword public 'DATA' use32
assume cs:_got
;org 804BFF0h
stderr_ptr dd offset stderr
__gmon_start___ptr dd offset __gmon_start__
stdin_ptr dd offset stdin
stdout_ptr dd offset stdout
_got ends


; Segment type: Pure data
; Segment permissions: Read/Write
_got_plt segment dword public 'DATA' use32
assume cs:_got_plt
;org 804C000h
_GLOBAL_OFFSET_TABLE_ dd offset _DYNAMIC
dword_804C004 dd 0
dword_804C008 dd 0
off_804C00C dd offset printf
off_804C010 dd offset gets
off_804C014 dd offset setgid
off_804C018 dd offset puts
off_804C01C dd offset __libc_start_main
off_804C020 dd offset setvbuf
off_804C024 dd offset sqrt
off_804C028 dd offset setuid
off_804C02C dd offset atoi
_got_plt ends


; Segment type: Pure data
; Segment permissions: Read/Write
_data segment dword public 'DATA' use32
assume cs:_data
;org 804C030h
public __data_start
__data_start db    0
db    0
db    0
db    0
public __dso_handle
__dso_handle db    0
db    0
db    0
db    0
_data ends


; Segment type: Uninitialized
; Segment permissions: Read/Write
_bss segment byte public 'BSS' use32
assume cs:_bss
;org 804C038h
assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
public __TMC_END__
__TMC_END__ db ?        ; Alternative name is 'completed.0'
                        ; Alternative name is '_edata'
                        ; Alternative name is '__bss_start'
align 4
_bss ends


; Segment type: Zero-length
_prgend segment byte public '' use32
_end label byte
_prgend ends


; Segment type: Externs
; extern
; int printf(const char *format, ...)
extrn printf:near
; char *gets(char *s)
extrn gets:near
; struct _IO_FILE *stderr
extrn stderr:dword
; int setgid(__gid_t gid)
extrn setgid:near
; int puts(const char *s)
extrn puts:near
; int _libc_start_main(int (*main)(int, char **, char **), int argc, char **ubp_av, void (*init)(), void (*fini)(), void (*rtld_fini)(), void *stack_end)
extrn __libc_start_main:near
; struct _IO_FILE *stdin
extrn stdin:dword
; int setvbuf(FILE *stream, char *buf, int modes, size_t n)
extrn setvbuf:near
; double sqrt(double x)
extrn sqrt:near
; struct _IO_FILE *stdout
extrn stdout:dword
; int setuid(__uid_t uid)
extrn setuid:near
; int atoi(const char *nptr)
extrn atoi:near
extrn __gmon_start__ ; weak


end _start
